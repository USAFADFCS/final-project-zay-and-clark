Category: defense evasion | Subtype: clearing bash history

Purpose: Recommended actions when logs indicate clearing bash history under defense evasion.

TLDR: Follow containment, investigation, eradication, and hardening steps.

High level actions:
- TLDR: Restore visibility. Re-enable logging and controls, and investigate tampering.
- Confirm: Disabled auditd or syslog, cleared histories, firewall changes, or disabled MAC.
- Contain: Reapply known-good configs and block the actor path.
- Investigate: Identify who disabled controls and when. Use remote logs for timeline.
- Eradicate and recover: Rebuild configs, re-enable agents, and reimage if integrity is doubtful.
- Hardening: Remote logging, protected logs, and configuration management to auto-heal changes.

Subtype specific steps:
- Check environment variables HISTFILE and HISTCONTROL and look for alternative shells.

Useful commands:
$ echo $HISTFILE $HISTCONTROL

Notes: Adjust commands for your distro. Preserve evidence before altering the system for forensics when severity is high.